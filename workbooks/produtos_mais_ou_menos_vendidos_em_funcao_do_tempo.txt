//devolve as Categorias mais vendidas num certo mês, com possiblidade de roll up e drill down

SELECT O100077.CATEGORIA, O100077.SUB_CATEGORIA, O100146.MES, SUM(O100170.UNID_VENDIDAS)
FROM BDII_1010834.DIM_PRODUTOS O100077, BDII_1010834.DIM_TEMPO O100146, BDII_1010834.FAC_VENDAS O100170
WHERE ( ( O100077.SURR_PRODUTO = O100170.SURR_PRODUTO ) AND ( O100146.SURR_TEMPO = O100170.SURR_TEMPO ) ) AND ( O100146.ANO = :"ano" )
GROUP BY O100077.CATEGORIA, O100077.SUB_CATEGORIA, O100146.MES
HAVING ( ( SUM(O100170.UNID_VENDIDAS) ) < :"unidades vendidas inferiores a" )
;
